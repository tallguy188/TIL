## How Does the Internet Work?



### Where to Begin?  Internet Addresses

------

인터넷은 각각 컴퓨터들이 연결되어 있는 글로벌 네트워크이기 때문에 반드시 각각 고유한 주소를 가지고 있어야 한다. 인터넷 주소의 form은 `nnn.nnn.nnn.nnn`(n은 반드시 숫자 0-255 사이어야 함)이다. 이 주소는 우리에게 `IP 주소`라고 알려져 있다. 아래의 일러스트는 두 컴퓨터가 인터넷으로 연결되어 있는 것을 보여준다. 여기서 인터넷은 두 컴퓨터 사이의 추상적인 객체로 표현되어 있다. 

![Diagram 1](http://web.stanford.edu/class/msande91si/www-spr04/readings/week1/InternetWhitepaper_files/ruswp_diag1.gif)

`ISP`(인터넷 서비스 공급자)를 통해 인터넷에 연결하는 경우 일반적으로 전화 접속 세션 동안 임시 IP주소가 할당된다. `LAN(Local Area Network)`에서 인터넷에 연결하는 경우 컴퓨터에 영구 IP주소가 있거나`DHCP(Dynamic Host Configuration Protocol)` 서버에서 임시 주소를 얻을 수 있다. 어쨌든 인터넷에 연결되어 있으면 컴퓨터에는 고유한 IP주소가 있다. 

>체크아웃 - ping program
>
>마이크로 소프트나 유닉스 계열을 사용중이고 인터넷에 연결되어 있는 경우 컴퓨터의 인터넷이 살아있는지 확인하는 방법이 있다. 이것은 `ping`이라고 불린다. 



### Protocol Stacks and Packets

------

컴퓨터는 인터넷에 연결되어 있으며 고유한 주소를 가지고 있다. 인터넷에 연결된 다른 컴퓨터와 어떻게 '대화'를 할까? 여기서 예시가 나온다. 만약 IP주소가 1.2.3.4이고 IP주소가 5.6.7.8인 컴퓨터에게 메시지를 보내려고 한다. 보내려는 메시지는 "Hello computer"이다. 분명히 메시지는 컴퓨터를 인터넷에 연결하는 전선을 통해 전송되어야 한다. 집에서 ISP에 전화를 걸어 메시지를 전화선을 통해 전송해야 한다고 가정하자. 따라서 메시지는 알파벳 텍스트에서 전자 신호로 번역되어 인터넷을 통해 전송된 다음 다시 알파벳 텍스트로 번역되어야 한다. 이것은 **프로토콜 스택** 을 사용하여 이루어진다. 모든 컴퓨터는 인터넷에서 통신하기 위해 이것이 필요하며 일반적으로 컴퓨터의 운영 체제에 내장되어 있다. 인터넷에서 사용되는 프로토콜 스택은 두가지 주요 통신 프로토콜 때문에 `TCP/IP`프로토콜 스택이라고 불린다. 

![다이어그램 2](http://web.stanford.edu/class/msande91si/www-spr04/readings/week1/InternetWhitepaper_files/ruswp_diag2.gif)

* 메시지는 컴퓨터의 프로토콜 스택 맨 위에서 시작하여 아래쪽으로 이동한다.
* 보낼 메시지가 길면 메시지가 통과하는 각 스택 계층에서 메시지를 더 작은 데이터 청크로 나눌 수 있다. 이는 인터넷을 통해 전송된 데이터가 관리 가능한 청크로 전송되기 떄문이다. 인터넷에서는 이러한 데이터 청크를 **패킷** 이라고 한다. 
* 패킷은 응용 프로그램 계층을 통과하여 TCP계층으로 이어진다. 각 패킷에는 포트 번호가 할당된다. 
* TCP계층을 거친 후 패킷은 IP계층으로 이동한다 .여기에서 각 패킷이 대상 주소인 5.6.7.8을 수신한다. 
* 이제 메시지 패킷에 포트 번호와 IP주소가 있으므로 인터넷을 통해 보낼 준비가 된것이다. 하드웨어 계층은 메시지의 알파벳 텍스트를 포함하는 패킷을 전자 신호로 변환하고 전화선을 통해 전송한다.
* 전화선의 다른 쪽 끝에는 ISP가 인터넷에 직접 연결되어 있다. ISP라우터는 각 패킷의 대상 주소를 검사하고 보낼 위치를 결정한다. 
* 결국 패킷은 컴퓨터 5.6.7.8에 도달한다. 여기에서 패킷은 대상 컴퓨터의 TCP/IP스택 맨 아래에서 시작하여 위쪽으로 작동한다. 
* 패킷이 스택을 통해 위쪽으로 이동하면 보내는 컴퓨터의 스택이 추가한 모든 라우팅 데이터가 패킷에서 제거된다. 
* 데이터가 스택의 맨 위에 도달하면 패킷이 원래 형식인 "Hello computer"로 다시 조립된다. 

### Networking Infra

------

이제 패킷이 인터넷을 통해 한 컴퓨터에서 다른 컴퓨터로 이동하는 방법을 알게 되었다. 그러나 그 사이에 무엇이 있을까? 실제로 인터넷을 구성하는 것은 무엇일까?

![다이어그램 3](http://web.stanford.edu/class/msande91si/www-spr04/readings/week1/InternetWhitepaper_files/ruswp_diag3.gif)

위에는 더 자세한 다이어그램이다. 

ISP는 전화 접속 고객을 위해 모뎀 풀을 유지관리한다. 이는 모뎀 풀에서 백본 또는 전용 회선 라이터로의 데이터 흐름을 제어하는 컴퓨터에 의해 관리된다. 이 설정은 네트워크에 대한 접근을 제공하므로 포트 서버라고 할 수 있다. 

패킷이 전화 네트워크와 ISP의 로컬 장비를 통과한 후 패킷은 ISP의 백본 또는 ISP가 대역폭을 사는 백본으로 라우팅된다. 여기에서 패킷은 목적지인 주소가 5.6.7.8인 컴퓨터를 찾을 때까지 일반적으로 여러 라우터와 여러 백본, 전용 회선 및 기타 네트워크를 통해 이동한다. 그러나 만약 우리 패킷이 정확한 경로를 알고 있다면 더 좋지 않을까? 방법이 있다. 

>체크 아웃 - Traceroute 프로그램
>
>윈도우나 유닉스 계열을 사용하고, 인터넷에 연결되어 있다면 편리한 프로그램이 있다. 이것은 Traceroute라고 하며 패킷이 주어진 인터넷 목적지로 가는 경로를 보여준다. Ping과 마찬가지로 명령 프롬프트에서 traceroute를 사용해야 한다. Ping과 마찬가지로 도메인 이름 대신 IP주소를 입력할 수도 있다. Traceroute는 패킷이 목적지에 도달하기 위해 통과해야 하는 모든 라우터, 컴퓨터 및 기타 인터넷 엔티티의 목록을 인쇄한다. 

Traceroute를 사용하면 패킷이 목적지에 도달하기 위해 많은 것을 거쳐야 하는 것을 알 수 있다. 